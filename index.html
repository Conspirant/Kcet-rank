<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KCET 2025 Rank Predictor | Advanced Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #0f172a, #1e293b);
            color: #f8fafc;
            min-height: 100vh;
        }
        
        .glow-box {
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.5);
        }
        
        .progress-ring__circle {
            transition: stroke-dashoffset 0.5s;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
        
        .tab-active {
            border-bottom: 3px solid #3b82f6;
            color: #3b82f6;
            font-weight: 600;
        }
        
        .college-card {
            transition: all 0.3s ease;
        }
        
        .college-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .rank-counter {
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
        }
        
        .disclaimer-modal {
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .mark-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            box-shadow: 0 0 5px rgba(0,0,0,0.5);
        }
        
        .mark-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            box-shadow: 0 0 5px rgba(0,0,0,0.5);
        }
        
        .subject-indicator {
            transition: all 0.3s ease;
        }
        
        .subject-indicator:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <header class="text-center mb-10">
            <h1 class="text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent mb-3">KCET 2025 Rank Predictor</h1>
            <p class="text-lg text-gray-300">Advanced calculator with AI-powered predictions and college recommendations</p>
        </header>

        <div id="mainContent">
            <!-- Tabs Navigation -->
            <div class="flex border-b border-gray-700 mb-8">
                <button data-tab="input" class="tab-active py-3 px-6 text-center font-medium">Input Marks</button>
                <button data-tab="result" class="py-3 px-6 text-center font-medium text-gray-400 hover:text-white">Predicted Rank</button>
                <button data-tab="breakdown" class="py-3 px-6 text-center font-medium text-gray-400 hover:text-white">Score Breakdown</button>
                <button data-tab="colleges" class="py-3 px-6 text-center font-medium text-gray-400 hover:text-white">College Suggestions</button>
            </div>

            <!-- Tab Content -->
            <div class="tab-content">
                <!-- Input Tab -->
                <div id="input" class="tab-pane active">
                    <div class="grid md:grid-cols-2 gap-8">
                        <!-- PUC Marks Section -->
                        <div class="bg-gray-800 rounded-xl p-6 glow-box">
                            <h2 class="text-xl font-bold mb-6 flex items-center">
                                <i class="fas fa-graduation-cap mr-2 text-blue-400"></i>
                                <span>PUC Marks (Out of 300)</span>
                            </h2>
                                                        
                            <div class="space-y-6">
                                <!-- Physics -->
                                <div>
                                    <div class="flex justify-between mb-2">
                                        <label class="font-medium">Physics</label>
                                        <div class="flex items-center">
                                            <button class="decrement-btn px-2 py-1 bg-gray-700 rounded-l-md" data-subject="pucPhysics" data-decrement="5">
                                                <i class="fas fa-minus"></i>
                                            </button>
                                            <input type="number" id="pucPhysics" value="60" min="0" max="100" class="w-16 text-center bg-gray-700 py-1">
                                            <button class="increment-btn px-2 py-1 bg-gray-700 rounded-r-md" data-subject="pucPhysics" data-increment="5">
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <input type="range" min="0" max="100" value="60" class="w-full mark-slider" id="pucPhysicsSlider">
                                    <div class="flex justify-between text-xs text-gray-400 mt-1">
                                        <span>0%</span>
                                        <span>100%</span>
                                    </div>
                                </div>
                                                                
                                <!-- Chemistry -->
                                <div>
                                    <div class="flex justify-between mb-2">
                                        <label class="font-medium">Chemistry</label>
                                        <div class="flex items-center">
                                            <button class="decrement-btn px-2 py-1 bg-gray-700 rounded-l-md" data-subject="pucChemistry" data-decrement="5">
                                                <i class="fas fa-minus"></i>
                                            </button>
                                            <input type="number" id="pucChemistry" value="60" min="0" max="100" class="w-16 text-center bg-gray-700 py-1">
                                            <button class="increment-btn px-2 py-1 bg-gray-700 rounded-r-md" data-subject="pucChemistry" data-increment="5">
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <input type="range" min="0" max="100" value="60" class="w-full mark-slider" id="pucChemistrySlider">
                                    <div class="flex justify-between text-xs text-gray-400 mt-1">
                                        <span>0%</span>
                                        <span>100%</span>
                                    </div>
                                </div>
                                                                
                                <!-- Mathematics -->
                                <div>
                                    <div class="flex justify-between mb-2">
                                        <label class="font-medium">Mathematics</label>
                                        <div class="flex items-center">
                                            <button class="decrement-btn px-2 py-1 bg-gray-700 rounded-l-md" data-subject="pucMath" data-decrement="5">
                                                <i class="fas fa-minus"></i>
                                            </button>
                                            <input type="number" id="pucMath" value="60" min="0" max="100" class="w-16 text-center bg-gray-700 py-1">
                                            <button class="increment-btn px-2 py-1 bg-gray-700 rounded-r-md" data-subject="pucMath" data-increment="5">
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <input type="range" min="0" max="100" value="60" class="w-full mark-slider" id="pucMathSlider">
                                    <div class="flex justify-between text-xs text-gray-400 mt-1">
                                        <span>0%</span>
                                        <span>100%</span>
                                    </div>
                                </div>
                            </div>
                                                        
                            <div class="mt-6 pt-4 border-t border-gray-700">
                                <div class="flex justify-between items-center">
                                    <span class="font-medium">PUC Total %</span>
                                    <span id="pucTotalPercent" class="text-xl font-bold">60%</span>
                                </div>
                                <div class="w-full bg-gray-700 rounded-full h-2.5 mt-2">
                                    <div id="pucProgressBar" class="bg-blue-600 h-2.5 rounded-full" style="width: 60%"></div>
                                </div>
                            </div>
                        </div>
                                                
                        <!-- KCET Marks Section -->
                        <div class="bg-gray-800 rounded-xl p-6 glow-box">
                            <h2 class="text-xl font-bold mb-6 flex items-center">
                                <i class="fas fa-pencil-alt mr-2 text-purple-400"></i>
                                <span>KCET Marks (Out of 180)</span>
                            </h2>
                                                        
                            <div class="space-y-6">
                                <!-- Physics -->
                                <div>
                                    <div class="flex justify-between mb-2">
                                        <label class="font-medium">Physics</label>
                                        <div class="flex items-center">
                                            <button class="decrement-btn px-2 py-1 bg-gray-700 rounded-l-md" data-subject="kcetPhysics" data-decrement="5">
                                                <i class="fas fa-minus"></i>
                                            </button>
                                            <input type="number" id="kcetPhysics" value="40" min="0" max="60" class="w-16 text-center bg-gray-700 py-1">
                                            <button class="increment-btn px-2 py-1 bg-gray-700 rounded-r-md" data-subject="kcetPhysics" data-increment="5">
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <input type="range" min="0" max="60" value="40" class="w-full mark-slider" id="kcetPhysicsSlider">
                                    <div class="flex justify-between text-xs text-gray-400 mt-1">
                                        <span>0</span>
                                        <span>60</span>
                                    </div>
                                </div>
                                                                
                                <!-- Chemistry -->
                                <div>
                                    <div class="flex justify-between mb-2">
                                        <label class="font-medium">Chemistry</label>
                                        <div class="flex items-center">
                                            <button class="decrement-btn px-2 py-1 bg-gray-700 rounded-l-md" data-subject="kcetChemistry" data-decrement="5">
                                                <i class="fas fa-minus"></i>
                                            </button>
                                            <input type="number" id="kcetChemistry" value="40" min="0" max="60" class="w-16 text-center bg-gray-700 py-1">
                                            <button class="increment-btn px-2 py-1 bg-gray-700 rounded-r-md" data-subject="kcetChemistry" data-increment="5">
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <input type="range" min="0" max="60" value="40" class="w-full mark-slider" id="kcetChemistrySlider">
                                    <div class="flex justify-between text-xs text-gray-400 mt-1">
                                        <span>0</span>
                                        <span>60</span>
                                    </div>
                                </div>
                                                                
                                <!-- Mathematics -->
                                <div>
                                    <div class="flex justify-between mb-2">
                                        <label class="font-medium">Mathematics</label>
                                        <div class="flex items-center">
                                            <button class="decrement-btn px-2 py-1 bg-gray-700 rounded-l-md" data-subject="kcetMath" data-decrement="5">
                                                <i class="fas fa-minus"></i>
                                            </button>
                                            <input type="number" id="kcetMath" value="40" min="0" max="60" class="w-16 text-center bg-gray-700 py-1">
                                            <button class="increment-btn px-2 py-1 bg-gray-700 rounded-r-md" data-subject="kcetMath" data-increment="5">
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <input type="range" min="0" max="60" value="40" class="w-full mark-slider" id="kcetMathSlider">
                                    <div class="flex justify-between text-xs text-gray-400 mt-1">
                                        <span>0</span>
                                        <span>60</span>
                                    </div>
                                </div>
                            </div>
                                                        
                            <div class="mt-6 pt-4 border-t border-gray-700">
                                <div class="flex justify-between items-center">
                                    <span class="font-medium">KCET Total %</span>
                                    <span id="kcetTotalPercent" class="text-xl font-bold">66.67%</span>
                                </div>
                                <div class="w-full bg-gray-700 rounded-full h-2.5 mt-2">
                                    <div id="kcetProgressBar" class="bg-purple-600 h-2.5 rounded-full" style="width: 66.67%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                                        
                    <!-- Additional Options -->
                    <div class="grid md:grid-cols-3 gap-6 mt-8">
                        <!-- Category Selection -->
                        <div class="bg-gray-800 rounded-xl p-6 glow-box">
                            <h2 class="text-xl font-bold mb-4 flex items-center">
                                <i class="fas fa-users mr-2 text-green-400"></i>
                                <span>Category</span>
                            </h2>
                            <select id="category" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="GM">General Merit (GM)</option>
                                <option value="OBC">Other Backward Classes (OBC)</option>
                                <option value="SC">Scheduled Caste (SC)</option>
                                <option value="ST">Scheduled Tribe (ST)</option>
                                <option value="Cat-1">Category-1</option>
                                <option value="Cat-2A">Category-2A</option>
                                <option value="Cat-2B">Category-2B</option>
                                <option value="Cat-3A">Category-3A</option>
                                <option value="Cat-3B">Category-3B</option>
                            </select>
                            <div class="mt-3 text-sm text-yellow-400 flex items-start">
                                <i class="fas fa-exclamation-circle mr-2 mt-1"></i>
                                <span>Category-based adjustments are estimates only. Refer to official KEA data for accurate cutoffs.</span>
                            </div>
                        </div>
                                                
                        <!-- Competition Level -->
                        <div class="bg-gray-800 rounded-xl p-6 glow-box">
                            <h2 class="text-xl font-bold mb-4 flex items-center">
                                <i class="fas fa-trophy mr-2 text-yellow-400"></i>
                                <span>Competition Level</span>
                            </h2>
                            <div class="space-y-3">
                                <div class="flex items-center">
                                    <input type="radio" id="normalComp" name="competition" value="normal" class="mr-2" checked>
                                    <label for="normalComp">Normal (Based on 2024 trends)</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="radio" id="highComp" name="competition" value="high" class="mr-2">
                                    <label for="highComp">High (Increased competition for 2025)</label>
                                </div>
                            </div>
                            <div class="mt-3 text-sm text-gray-400">
                                <i class="fas fa-info-circle mr-2"></i>
                                High competition increases predicted rank by 10-15%
                            </div>
                        </div>
                                                
                        <!-- Prediction Mode -->
                        <div class="bg-gray-800 rounded-xl p-6 glow-box">
                            <h2 class="text-xl font-bold mb-4 flex items-center">
                                <i class="fas fa-chart-line mr-2 text-red-400"></i>
                                <span>Prediction Mode</span>
                            </h2>
                            <div class="space-y-3">
                                <div class="flex items-center">
                                    <input type="radio" id="standardMode" name="predictionMode" value="standard" class="mr-2" checked>
                                    <label for="standardMode">Standard (Most likely scenario)</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="radio" id="optimisticMode" name="predictionMode" value="optimistic" class="mr-2">
                                    <label for="optimisticMode">Optimistic (Best case scenario)</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="radio" id="conservativeMode" name="predictionMode" value="conservative" class="mr-2">
                                    <label for="conservativeMode">Conservative (Worst case scenario)</label>
                                </div>
                            </div>
                        </div>
                    </div>
                                        
                    <!-- Calculate Button -->
                    <div class="mt-10 text-center">
                        <button id="calculateBtn" class="bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-bold py-3 px-8 rounded-full text-lg shadow-lg transition-all transform hover:scale-105">
                            <i class="fas fa-calculator mr-2"></i> Calculate My Rank
                        </button>
                    </div>
                </div>
                                
                <!-- Result Tab -->
                <div id="result" class="tab-pane hidden">
                    <div class="bg-gray-800 rounded-xl p-8 glow-box">
                        <div class="text-center mb-8">
                            <h2 class="text-2xl font-bold mb-2">Your Predicted KCET 2025 Rank</h2>
                            <p class="text-gray-400">Based on current marks and selected parameters</p>
                        </div>
                                                
                        <div class="flex flex-col md:flex-row items-center justify-around">
                            <!-- Rank Display -->
                            <div class="text-center mb-8 md:mb-0">
                                <div class="text-5xl md:text-7xl font-bold rank-counter text-blue-400" id="finalRank">
                                    --
                                </div>
                                <div class="text-lg mt-2">Approximate Rank</div>
                                <div class="text-sm text-gray-400 mt-1">Range: <span id="rankRange">-- to --</span></div>
                            </div>
                                                        
                            <!-- Rank Quality Indicator -->
                            <div class="relative w-48 h-48">
                                <svg class="w-full h-full" viewBox="0 0 100 100">
                                    <circle class="text-gray-700" stroke-width="8" stroke="currentColor" fill="transparent" r="40" cx="50" cy="50" />
                                    <circle class="progress-ring__circle text-blue-500" stroke-width="8" stroke-linecap="round" stroke="currentColor" fill="transparent" r="40" cx="50" cy="50" id="rankQualityCircle" />
                                </svg>
                                <div class="absolute inset-0 flex flex-col items-center justify-center">
                                    <div id="rankQualityText" class="text-xl font-bold">--</div>
                                    <div id="rankPercentile" class="text-sm text-gray-400">Top --%</div>
                                </div>
                            </div>
                                                        
                            <!-- Category Adjusted Rank -->
                            <div class="text-center mt-8 md:mt-0">
                                <div class="text-3xl md:text-5xl font-bold rank-counter text-purple-400" id="categoryRank">
                                    --
                                </div>
                                <div class="text-lg mt-2">Category Adjusted Rank</div>
                                <div class="text-sm text-gray-400 mt-1" id="categoryInfo">For <span id="selectedCategory">GM</span> candidates</div>
                            </div>
                        </div>
                                                
                        <div class="mt-10 pt-6 border-t border-gray-700">
                            <h3 class="text-lg font-bold mb-4">What This Rank Means</h3>
                            <div id="rankInterpretation" class="text-gray-300">
                                Enter your marks and click "Calculate My Rank" to see your predicted KCET 2025 rank and what it means for your college options.
                            </div>
                        </div>
                                                
                        <div class="mt-8 flex justify-center">
                            <button id="backToInput" class="bg-gray-700 hover:bg-gray-600 text-white font-medium py-2 px-6 rounded-lg mr-4">
                                <i class="fas fa-edit mr-2"></i> Edit Inputs
                            </button>
                            <button id="viewBreakdown" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg">
                                <i class="fas fa-chart-pie mr-2"></i> View Breakdown
                            </button>
                        </div>
                    </div>
                </div>
                                
                <!-- Breakdown Tab -->
                <div id="breakdown" class="tab-pane hidden">
                    <div class="bg-gray-800 rounded-xl p-8 glow-box">
                        <div class="text-center mb-8">
                            <h2 class="text-2xl font-bold mb-2">Score Breakdown</h2>
                            <p class="text-gray-400">Detailed analysis of your predicted performance</p>
                        </div>
                                                
                        <div class="grid md:grid-cols-2 gap-8 mb-10">
                            <!-- Final Score Breakdown -->
                            <div>
                                <h3 class="text-lg font-bold mb-4 flex items-center">
                                    <i class="fas fa-percentage mr-2 text-blue-400"></i>
                                    <span>Final Score Calculation</span>
                                </h3>
                                <div class="bg-gray-700 rounded-lg p-4">
                                    <div class="flex justify-between py-2 border-b border-gray-600">
                                        <span>PUC Score (50%)</span>
                                        <span id="breakdownPucScore">30.00%</span>
                                    </div>
                                    <div class="flex justify-between py-2 border-b border-gray-600">
                                        <span>KCET Score (50%)</span>
                                        <span id="breakdownKcetScore">33.33%</span>
                                    </div>
                                    <div class="flex justify-between py-2 font-bold text-lg">
                                        <span>Final Composite Score</span>
                                        <span id="breakdownFinalScore">63.33%</span>
                                    </div>
                                </div>
                                                                
                                <div class="mt-6">
                                    <canvas id="scoreChart" height="200"></canvas>
                                </div>
                            </div>
                                                        
                            <!-- Subject Performance -->
                            <div>
                                <h3 class="text-lg font-bold mb-4 flex items-center">
                                    <i class="fas fa-book-open mr-2 text-purple-400"></i>
                                    <span>Subject Performance</span>
                                </h3>
                                                                
                                <div class="grid grid-cols-2 gap-4">
                                    <!-- PUC Subjects -->
                                    <div class="bg-gray-700 rounded-lg p-4">
                                        <div class="text-center font-medium mb-3 text-blue-300">PUC Subjects</div>
                                        <div class="space-y-4">
                                            <div class="subject-indicator">
                                                <div class="flex justify-between mb-1">
                                                    <span class="text-sm">Physics</span>
                                                    <span class="text-sm font-medium" id="breakdownPucPhysics">60%</span>
                                                </div>
                                                <div class="w-full bg-gray-600 rounded-full h-2">
                                                    <div class="bg-blue-500 h-2 rounded-full" id="pucPhysicsBar"></div>
                                                </div>
                                                <div class="text-xs text-right mt-1" id="pucPhysicsLabel">Good</div>
                                            </div>
                                            <div class="subject-indicator">
                                                <div class="flex justify-between mb-1">
                                                    <span class="text-sm">Chemistry</span>
                                                    <span class="text-sm font-medium" id="breakdownPucChemistry">60%</span>
                                                </div>
                                                <div class="w-full bg-gray-600 rounded-full h-2">
                                                    <div class="bg-blue-500 h-2 rounded-full" id="pucChemistryBar"></div>
                                                </div>
                                                <div class="text-xs text-right mt-1" id="pucChemistryLabel">Good</div>
                                            </div>
                                            <div class="subject-indicator">
                                                <div class="flex justify-between mb-1">
                                                    <span class="text-sm">Mathematics</span>
                                                    <span class="text-sm font-medium" id="breakdownPucMath">60%</span>
                                                </div>
                                                <div class="w-full bg-gray-600 rounded-full h-2">
                                                    <div class="bg-blue-500 h-2 rounded-full" id="pucMathBar"></div>
                                                </div>
                                                <div class="text-xs text-right mt-1" id="pucMathLabel">Good</div>
                                            </div>
                                        </div>
                                    </div>
                                                                        
                                    <!-- KCET Subjects -->
                                    <div class="bg-gray-700 rounded-lg p-4">
                                        <div class="text-center font-medium mb-3 text-purple-300">KCET Subjects</div>
                                        <div class="space-y-4">
                                            <div class="subject-indicator">
                                                <div class="flex justify-between mb-1">
                                                    <span class="text-sm">Physics</span>
                                                    <span class="text-sm font-medium" id="breakdownKcetPhysics">66.67%</span>
                                                </div>
                                                <div class="w-full bg-gray-600 rounded-full h-2">
                                                    <div class="bg-purple-500 h-2 rounded-full" id="kcetPhysicsBar"></div>
                                                </div>
                                                <div class="text-xs text-right mt-1" id="kcetPhysicsLabel">Good</div>
                                            </div>
                                            <div class="subject-indicator">
                                                <div class="flex justify-between mb-1">
                                                    <span class="text-sm">Chemistry</span>
                                                    <span class="text-sm font-medium" id="breakdownKcetChemistry">66.67%</span>
                                                </div>
                                                <div class="w-full bg-gray-600 rounded-full h-2">
                                                    <div class="bg-purple-500 h-2 rounded-full" id="kcetChemistryBar"></div>
                                                </div>
                                                <div class="text-xs text-right mt-1" id="kcetChemistryLabel">Good</div>
                                            </div>
                                            <div class="subject-indicator">
                                                <div class="flex justify-between mb-1">
                                                    <span class="text-sm">Mathematics</span>
                                                    <span class="text-sm font-medium" id="breakdownKcetMath">66.67%</span>
                                                </div>
                                                <div class="w-full bg-gray-600 rounded-full h-2">
                                                    <div class="bg-purple-500 h-2 rounded-full" id="kcetMathBar"></div>
                                                </div>
                                                <div class="text-xs text-right mt-1" id="kcetMathLabel">Good</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                                                
                        <!-- Rank Factors -->
                        <div>
                            <h3 class="text-lg font-bold mb-4 flex items-center">
                                <i class="fas fa-cogs mr-2 text-green-400"></i>
                                <span>Rank Adjustment Factors</span>
                            </h3>
                                                        
                            <div class="grid md:grid-cols-3 gap-4">
                                <div class="bg-gray-700 rounded-lg p-4">
                                    <div class="font-medium mb-2">Competition Level</div>
                                    <div class="text-2xl font-bold text-blue-400" id="competitionFactor">Normal</div>
                                    <div class="text-xs text-gray-400 mt-1" id="competitionImpact">Based on 2024 trends</div>
                                </div>
                                <div class="bg-gray-700 rounded-lg p-4">
                                    <div class="font-medium mb-2">Prediction Mode</div>
                                    <div class="text-2xl font-bold text-purple-400" id="predictionModeFactor">Standard</div>
                                    <div class="text-xs text-gray-400 mt-1" id="predictionImpact">Most likely scenario</div>
                                </div>
                                <div class="bg-gray-700 rounded-lg p-4">
                                    <div class="font-medium mb-2">Category</div>
                                    <div class="text-2xl font-bold text-green-400" id="categoryFactor">GM</div>
                                    <div class="text-xs text-gray-400 mt-1" id="categoryImpact">No rank adjustment</div>
                                </div>
                            </div>
                        </div>
                                                        
                        <div class="mt-8 flex justify-center">
                            <button id="backToResult" class="bg-gray-700 hover:bg-gray-600 text-white font-medium py-2 px-6 rounded-lg mr-4">
                                <i class="fas fa-arrow-left mr-2"></i> Back to Result
                            </button>
                            <button id="viewColleges" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-6 rounded-lg">
                                <i class="fas fa-university mr-2"></i> View College Suggestions
                            </button>
                        </div>
                    </div>
                </div>
                                
                <!-- College Suggestions Tab -->
                <div id="colleges" class="tab-pane hidden">
                    <div class="bg-gray-800 rounded-xl p-8 glow-box">
                        <div class="text-center mb-8">
                            <h2 class="text-2xl font-bold mb-2">College Suggestions</h2>
                            <p class="text-gray-400">NOT Based on your predicted rank and category <br>
                            just in developmeent</p>
                        </div>
                                                
                        <!-- College Tier Filter -->
                        <div class="mb-8">
                            <h3 class="text-lg font-bold mb-4">Filter by College Tier</h3>
                            <div class="flex flex-wrap gap-2">
                                <button class="college-filter-btn active bg-blue-600 text-white px-4 py-2 rounded-full text-sm" data-tier="all">
                                    All Colleges
                                </button>
                                <button class="college-filter-btn bg-purple-600 text-white px-4 py-2 rounded-full text-sm" data-tier="tier1">
                                    Tier 1 (Top Govt.)
                                </button>
                                <button class="college-filter-btn bg-green-600 text-white px-4 py-2 rounded-full text-sm" data-tier="tier2">
                                    Tier 2 (Good Pvt.)
                                </button>
                                <button class="college-filter-btn bg-yellow-600 text-white px-4 py-2 rounded-full text-sm" data-tier="tier3">
                                    Tier 3 (Other)
                                </button>
                            </div>
                        </div>
                                                
                        <!-- College Cards -->
                        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="collegeContainer">
                            <!-- Colleges will be dynamically inserted here -->
                        </div>
                                                
                        <div class="mt-8 text-center text-gray-400">
                            <p><i class="fas fa-info-circle mr-2"></i> These are estimated suggestions based on previous year cutoffs. Actual seat allocation may vary.</p>
                        </div>
                                                
                        <div class="mt-8 flex justify-center">
                            <button id="backToBreakdown" class="bg-gray-700 hover:bg-gray-600 text-white font-medium py-2 px-6 rounded-lg">
                                <i class="fas fa-arrow-left mr-2"></i> Back to Breakdown
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // College data
        const colleges = [
            {
                name: "RV College of Engineering, Bangalore",
                tier: "tier1",
                branches: [
                    { name: "Computer Science", cutoff: 500, yourChance: "high" },
                    { name: "Electronics", cutoff: 1500, yourChance: "medium" },
                    { name: "Mechanical", cutoff: 3000, yourChance: "low" }
                ],
                badge: "Top Choice",
                badgeColor: "bg-red-500"
            },
            {
                name: "PES University, Bangalore",
                tier: "tier1",
                branches: [
                    { name: "Computer Science", cutoff: 300, yourChance: "high" },
                    { name: "Artificial Intelligence", cutoff: 800, yourChance: "high" },
                    { name: "Electrical", cutoff: 2500, yourChance: "medium" }
                ],
                badge: "Highly Rated",
                badgeColor: "bg-blue-500"
            },
            {
                name: "BMS College of Engineering, Bangalore",
                tier: "tier1",
                branches: [
                    { name: "Computer Science", cutoff: 600, yourChance: "high" },
                    { name: "Information Science", cutoff: 1200, yourChance: "medium" },
                    { name: "Civil", cutoff: 3500, yourChance: "low" }
                ],
                badge: "Established",
                badgeColor: "bg-green-500"
            },
            {
                name: "MS Ramaiah Institute of Technology",
                tier: "tier1",
                branches: [
                    { name: "Computer Science", cutoff: 700, yourChance: "high" },
                    { name: "Electronics", cutoff: 1800, yourChance: "medium" },
                    { name: "Biotechnology", cutoff: 4000, yourChance: "low" }
                ],
                badge: "Reputed",
                badgeColor: "bg-purple-500"
            },
            {
                name: "Dayananda Sagar College of Engineering",
                tier: "tier2",
                branches: [
                    { name: "Computer Science", cutoff: 1500, yourChance: "medium" },
                    { name: "Mechanical", cutoff: 4500, yourChance: "low" },
                    { name: "Civil", cutoff: 6000, yourChance: "low" }
                ],
                badge: "Good Placement",
                badgeColor: "bg-yellow-500"
            },
            {
                name: "Nitte Meenakshi Institute of Technology",
                tier: "tier2",
                branches: [
                    { name: "Computer Science", cutoff: 2500, yourChance: "medium" },
                    { name: "Electronics", cutoff: 5000, yourChance: "low" },
                    { name: "Aerospace", cutoff: 8000, yourChance: "low" }
                ],
                badge: "Emerging",
                badgeColor: "bg-indigo-500"
            },
            {
                name: "SJB Institute of Technology",
                tier: "tier3",
                branches: [
                    { name: "Computer Science", cutoff: 8000, yourChance: "low" },
                    { name: "Information Science", cutoff: 12000, yourChance: "low" },
                    { name: "Mechanical", cutoff: 20000, yourChance: "low" }
                ],
                badge: "Affordable",
                badgeColor: "bg-gray-500"
            },
            {
                name: "New Horizon College of Engineering",
                tier: "tier3",
                branches: [
                    { name: "Computer Science", cutoff: 10000, yourChance: "low" },
                    { name: "Electronics", cutoff: 15000, yourChance: "low" },
                    { name: "Civil", cutoff: 25000, yourChance: "low" }
                ],
                badge: "Good Infrastructure",
                badgeColor: "bg-pink-500"
            }
        ];

        // DOM Elements
        const mainContent = document.getElementById('mainContent');
        const calculateBtn = document.getElementById('calculateBtn');
        const tabButtons = document.querySelectorAll('[data-tab]');
        const tabPanes = document.querySelectorAll('.tab-pane');
        const backToInput = document.getElementById('backToInput');
        const viewBreakdown = document.getElementById('viewBreakdown');
        const backToResult = document.getElementById('backToResult');
        const viewColleges = document.getElementById('viewColleges');
        const backToBreakdown = document.getElementById('backToBreakdown');
        const collegeFilterBtns = document.querySelectorAll('.college-filter-btn');
        const collegeContainer = document.getElementById('collegeContainer');
                
        // Input elements
        const pucPhysics = document.getElementById('pucPhysics');
        const pucChemistry = document.getElementById('pucChemistry');
        const pucMath = document.getElementById('pucMath');
        const kcetPhysics = document.getElementById('kcetPhysics');
        const kcetChemistry = document.getElementById('kcetChemistry');
        const kcetMath = document.getElementById('kcetMath');
        const pucPhysicsSlider = document.getElementById('pucPhysicsSlider');
        const pucChemistrySlider = document.getElementById('pucChemistrySlider');
        const pucMathSlider = document.getElementById('pucMathSlider');
        const kcetPhysicsSlider = document.getElementById('kcetPhysicsSlider');
        const kcetChemistrySlider = document.getElementById('kcetChemistrySlider');
        const kcetMathSlider = document.getElementById('kcetMathSlider');
        const pucTotalPercent = document.getElementById('pucTotalPercent');
        const kcetTotalPercent = document.getElementById('kcetTotalPercent');
        const pucProgressBar = document.getElementById('pucProgressBar');
        const kcetProgressBar = document.getElementById('kcetProgressBar');
        const categorySelect = document.getElementById('category');
                
        // Result elements
        const finalRank = document.getElementById('finalRank');
        const rankRange = document.getElementById('rankRange');
        const rankQualityCircle = document.getElementById('rankQualityCircle');
        const rankQualityText = document.getElementById('rankQualityText');
        const rankPercentile = document.getElementById('rankPercentile');
        const categoryRank = document.getElementById('categoryRank');
        const selectedCategory = document.getElementById('selectedCategory');
        const categoryInfo = document.getElementById('categoryInfo');
        const rankInterpretation = document.getElementById('rankInterpretation');
                
        // Breakdown elements
        const breakdownPucScore = document.getElementById('breakdownPucScore');
        const breakdownKcetScore = document.getElementById('breakdownKcetScore');
        const breakdownFinalScore = document.getElementById('breakdownFinalScore');
        const breakdownPucPhysics = document.getElementById('breakdownPucPhysics');
        const breakdownPucChemistry = document.getElementById('breakdownPucChemistry');
        const breakdownPucMath = document.getElementById('breakdownPucMath');
        const breakdownKcetPhysics = document.getElementById('breakdownKcetPhysics');
        const breakdownKcetChemistry = document.getElementById('breakdownKcetChemistry');
        const breakdownKcetMath = document.getElementById('breakdownKcetMath');
        const competitionFactor = document.getElementById('competitionFactor');
        const competitionImpact = document.getElementById('competitionImpact');
        const predictionModeFactor = document.getElementById('predictionModeFactor');
        const predictionImpact = document.getElementById('predictionImpact');
        const categoryFactor = document.getElementById('categoryFactor');
        const categoryImpact = document.getElementById('categoryImpact');
                
        // Subject performance labels
        const pucPhysicsLabel = document.getElementById('pucPhysicsLabel');
        const pucChemistryLabel = document.getElementById('pucChemistryLabel');
        const pucMathLabel = document.getElementById('pucMathLabel');
        const kcetPhysicsLabel = document.getElementById('kcetPhysicsLabel');
        const kcetChemistryLabel = document.getElementById('kcetChemistryLabel');
        const kcetMathLabel = document.getElementById('kcetMathLabel');
                
        // Subject progress bars
        const pucPhysicsBar = document.getElementById('pucPhysicsBar');
        const pucChemistryBar = document.getElementById('pucChemistryBar');
        const pucMathBar = document.getElementById('pucMathBar');
        const kcetPhysicsBar = document.getElementById('kcetPhysicsBar');
        const kcetChemistryBar = document.getElementById('kcetChemistryBar');
        const kcetMathBar = document.getElementById('kcetMathBar');
                
        // Chart
        let scoreChart;
                
        // Variables to store calculations
        let currentRank = 0;
        let currentCategoryRank = 0;
        let currentFinalScore = 0;
                
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Set up event listeners for sliders and input fields
            setupInputListeners();
                        
            // Set up tab navigation
            setupTabs();
                        
            // Set up college filter buttons
            setupCollegeFilters();
                        
            // Initialize chart
            initializeChart();
        });
                
        function setupInputListeners() {
            // PUC Physics
            pucPhysics.addEventListener('input', function() {
                const value = Math.min(100, Math.max(0, parseInt(this.value) || 0));
                this.value = value;
                pucPhysicsSlider.value = value;
                updatePucTotal();
                updateSubjectLabels();
            });
                        
            pucPhysicsSlider.addEventListener('input', function() {
                pucPhysics.value = this.value;
                updatePucTotal();
                updateSubjectLabels();
            });
                        
            // PUC Chemistry
            pucChemistry.addEventListener('input', function() {
                const value = Math.min(100, Math.max(0, parseInt(this.value) || 0));
                this.value = value;
                pucChemistrySlider.value = value;
                updatePucTotal();
                updateSubjectLabels();
            });
                        
            pucChemistrySlider.addEventListener('input', function() {
                pucChemistry.value = this.value;
                updatePucTotal();
                updateSubjectLabels();
            });
                        
            // PUC Math
            pucMath.addEventListener('input', function() {
                const value = Math.min(100, Math.max(0, parseInt(this.value) || 0));
                this.value = value;
                pucMathSlider.value = value;
                updatePucTotal();
                updateSubjectLabels();
            });
                        
            pucMathSlider.addEventListener('input', function() {
                pucMath.value = this.value;
                updatePucTotal();
                updateSubjectLabels();
            });
                        
            // KCET Physics
            kcetPhysics.addEventListener('input', function() {
                const value = Math.min(60, Math.max(0, parseInt(this.value) || 0));
                this.value = value;
                kcetPhysicsSlider.value = value;
                updateKcetTotal();
                updateSubjectLabels();
            });
                        
            kcetPhysicsSlider.addEventListener('input', function() {
                kcetPhysics.value = this.value;
                updateKcetTotal();
                updateSubjectLabels();
            });
                        
            // KCET Chemistry
            kcetChemistry.addEventListener('input', function() {
                const value = Math.min(60, Math.max(0, parseInt(this.value) || 0));
                this.value = value;
                kcetChemistrySlider.value = value;
                updateKcetTotal();
                updateSubjectLabels();
            });
                        
            kcetChemistrySlider.addEventListener('input', function() {
                kcetChemistry.value = this.value;
                updateKcetTotal();
                updateSubjectLabels();
            });
                        
            // KCET Math
            kcetMath.addEventListener('input', function() {
                const value = Math.min(60, Math.max(0, parseInt(this.value) || 0));
                this.value = value;
                kcetMathSlider.value = value;
                updateKcetTotal();
                updateSubjectLabels();
            });
                        
            kcetMathSlider.addEventListener('input', function() {
                kcetMath.value = this.value;
                updateKcetTotal();
                updateSubjectLabels();
            });
                        
            // Increment/Decrement buttons
            document.querySelectorAll('.increment-btn, .decrement-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const isIncrement = this.classList.contains('increment-btn');
                    const subject = this.getAttribute('data-subject');
                    const amount = isIncrement ? parseInt(this.getAttribute('data-increment')) : -parseInt(this.getAttribute('data-decrement'));
                                        
                    const inputElement = document.getElementById(subject);
                    const sliderElement = document.getElementById(`${subject}Slider`);
                                        
                    let newValue = parseInt(inputElement.value) + amount;
                                        
                    if (subject.startsWith('puc')) {
                        newValue = Math.min(100, Math.max(0, newValue));
                    } else {
                        newValue = Math.min(60, Math.max(0, newValue));
                    }
                                        
                    inputElement.value = newValue;
                    sliderElement.value = newValue;
                                        
                    if (subject.startsWith('puc')) {
                        updatePucTotal();
                    } else {
                        updateKcetTotal();
                    }
                                        
                    updateSubjectLabels();
                });
            });
                        
            // Calculate button
            calculateBtn.addEventListener('click', calculateRank);
                        
            // Navigation buttons
            backToInput.addEventListener('click', () => switchTab('input'));
            viewBreakdown.addEventListener('click', () => switchTab('breakdown'));
            backToResult.addEventListener('click', () => switchTab('result'));
            viewColleges.addEventListener('click', () => {
                switchTab('colleges');
                renderColleges('all');
            });
            backToBreakdown.addEventListener('click', () => switchTab('breakdown'));
        }
                
        function setupTabs() {
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });
        }
                
        function switchTab(tabName) {
            // Update active tab button
            tabButtons.forEach(button => {
                if (button.getAttribute('data-tab') === tabName) {
                    button.classList.add('tab-active');
                    button.classList.remove('text-gray-400', 'hover:text-white');
                } else {
                    button.classList.remove('tab-active');
                    button.classList.add('text-gray-400', 'hover:text-white');
                }
            });
                        
            // Show active tab pane
            tabPanes.forEach(pane => {
                if (pane.id === tabName) {
                    pane.classList.remove('hidden');
                    pane.classList.add('active');
                } else {
                    pane.classList.add('hidden');
                    pane.classList.remove('active');
                }
            });
        }
                
        function setupCollegeFilters() {
            collegeFilterBtns.forEach(button => {
                button.addEventListener('click', function() {
                    const tier = this.getAttribute('data-tier');
                                        
                    // Update active button
                    collegeFilterBtns.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                                        
                    // Render colleges
                    renderColleges(tier);
                });
            });
        }
                
        function initializeChart() {
            const ctx = document.getElementById('scoreChart').getContext('2d');
            scoreChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['PUC Score (50%)', 'KCET Score (50%)'],
                    datasets: [{
                        data: [30, 33.33],
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(124, 58, 237, 0.8)'
                        ],
                        borderColor: [
                            'rgba(59, 130, 246, 1)',
                            'rgba(124, 58, 237, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#f8fafc'
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.label}: ${context.raw}%`;
                                }
                            }
                        }
                    },
                    cutout: '70%'
                }
            });
        }
                
        function updatePucTotal() {
            const physics = parseInt(pucPhysics.value);
            const chemistry = parseInt(pucChemistry.value);
            const math = parseInt(pucMath.value);
                        
            const total = (physics + chemistry + math) / 3;
            const roundedTotal = Math.round(total * 100) / 100;
                        
            pucTotalPercent.textContent = `${roundedTotal}%`;
            pucProgressBar.style.width = `${roundedTotal}%`;
                        
            // Update breakdown
            breakdownPucScore.textContent = `${(roundedTotal * 0.5).toFixed(2)}%`;
            breakdownPucPhysics.textContent = `${physics}%`;
            breakdownPucChemistry.textContent = `${chemistry}%`;
            breakdownPucMath.textContent = `${math}%`;
                        
            // Update progress bars
            pucPhysicsBar.style.width = `${physics}%`;
            pucChemistryBar.style.width = `${chemistry}%`;
            pucMathBar.style.width = `${math}%`;
        }
                
        function updateKcetTotal() {
            const physics = parseInt(kcetPhysics.value);
            const chemistry = parseInt(kcetChemistry.value);
            const math = parseInt(kcetMath.value);
                        
            const total = ((physics + chemistry + math) / 180) * 100;
            const roundedTotal = Math.round(total * 100) / 100;
                        
            kcetTotalPercent.textContent = `${roundedTotal}%`;
            kcetProgressBar.style.width = `${roundedTotal}%`;
                        
            // Update breakdown
            breakdownKcetScore.textContent = `${(roundedTotal * 0.5).toFixed(2)}%`;
            breakdownKcetPhysics.textContent = `${((physics / 60) * 100).toFixed(2)}%`;
            breakdownKcetChemistry.textContent = `${((chemistry / 60) * 100).toFixed(2)}%`;
            breakdownKcetMath.textContent = `${((math / 60) * 100).toFixed(2)}%`;
                        
            // Update progress bars
            kcetPhysicsBar.style.width = `${(physics / 60) * 100}%`;
            kcetChemistryBar.style.width = `${(chemistry / 60) * 100}%`;
            kcetMathBar.style.width = `${(math / 60) * 100}%`;
        }
                
        function updateSubjectLabels() {
            // PUC Subjects
            updateSubjectLabel(pucPhysics.value, pucPhysicsLabel);
            updateSubjectLabel(pucChemistry.value, pucChemistryLabel);
            updateSubjectLabel(pucMath.value, pucMathLabel);
                        
            // KCET Subjects
            updateSubjectLabel((kcetPhysics.value / 60 * 100).toFixed(0), kcetPhysicsLabel);
            updateSubjectLabel((kcetChemistry.value / 60 * 100).toFixed(0), kcetChemistryLabel);
            updateSubjectLabel((kcetMath.value / 60 * 100).toFixed(0), kcetMathLabel);
        }
                
        function updateSubjectLabel(score, labelElement) {
            const percent = parseInt(score);
                        
            if (percent >= 85) {
                labelElement.textContent = "Excellent";
                labelElement.className = "text-xs text-right mt-1 text-green-400";
            } else if (percent >= 70) {
                labelElement.textContent = "Good";
                labelElement.className = "text-xs text-right mt-1 text-blue-400";
            } else if (percent >= 50) {
                labelElement.textContent = "Average";
                labelElement.className = "text-xs text-right mt-1 text-yellow-400";
            } else {
                labelElement.textContent = "Needs Improvement";
                labelElement.className = "text-xs text-right mt-1 text-red-400";
            }
        }
        function estimateRealisticRank(score) {
    if (score >= 99.5) return 1;
    if (score >= 99) return 10;
    if (score >= 98.5) return 25;
    if (score >= 98) return 50;
    if (score >= 97) return 100;
    if (score >= 96) return 250;
    if (score >= 95) return 400;
    if (score >= 94) return 600;
    if (score >= 93) return 900;
    if (score >= 92) return 1300;
    if (score >= 91) return 1700;
    if (score >= 90) return 2100;
    if (score >= 89) return 2500;
    if (score >= 88) return 3000;
    if (score >= 87) return 3700;
    if (score >= 86) return 4500;
    if (score >= 85) return 5500;
    if (score >= 84) return 6500;
    if (score >= 83) return 7700;
    if (score >= 82) return 9000;
    if (score >= 81) return 10500;
    if (score >= 80) return 12000;
    if (score >= 78) return 14500;
    if (score >= 76) return 17000;
    if (score >= 74) return 20000;
    if (score >= 72) return 24000;
    if (score >= 70) return 28000;
    if (score >= 68) return 33000;
    if (score >= 66) return 38000;
    if (score >= 64) return 44000;
    if (score >= 62) return 50000;
    if (score >= 60) return 57000;
    if (score >= 58) return 64000;
    if (score >= 56) return 72000;
    if (score >= 54) return 80000;
    if (score >= 52) return 89000;
    if (score >= 50) return 98000;
    return 100000;
}

                
        function calculateRank() {
            // Get PUC and KCET totals
            const pucTotal = parseFloat(pucTotalPercent.textContent);
            const kcetTotal = parseFloat(kcetTotalPercent.textContent);
                        
            // Calculate final score (50% PUC + 50% KCET)
            currentFinalScore = (pucTotal * 0.5) + (kcetTotal * 0.5);
            breakdownFinalScore.textContent = `${currentFinalScore.toFixed(2)}%`;
                        
            // Update chart
            scoreChart.data.datasets[0].data = [pucTotal * 0.5, kcetTotal * 0.5];
            scoreChart.update();
                        
            // Get competition level
            const competitionLevel = document.querySelector('input[name="competition"]:checked').value;
                        
            // Get prediction mode
            const predictionMode = document.querySelector('input[name="predictionMode"]:checked').value;
                        
            // Get category
            const category = categorySelect.value;
            selectedCategory.textContent = category;
                        
            // Calculate base rank using the formula: 100000 * (1 - (Final Score / 100))
            currentRank = estimateRealisticRank(currentFinalScore);
                        
            // Adjust for competition level
            if (competitionLevel === 'high') {
                currentRank = Math.round(currentRank * 1.15); // 15% worse rank for high competition
                competitionFactor.textContent = "High";
                competitionImpact.textContent = "Increased competition for 2025 (+15% rank)";
            } else {
                competitionFactor.textContent = "Normal";
                competitionImpact.textContent = "Based on 2024 trends";
            }
                        
            // Adjust for prediction mode
            if (predictionMode === 'optimistic') {
                currentRank = Math.round(currentRank * 0.9); // 10% better rank
                predictionModeFactor.textContent = "Optimistic";
                predictionImpact.textContent = "Best case scenario (-10% rank)";
            } else if (predictionMode === 'conservative') {
                currentRank = Math.round(currentRank * 1.1); // 10% worse rank
                predictionModeFactor.textContent = "Conservative";
                predictionImpact.textContent = "Worst case scenario (+10% rank)";
            } else {
                predictionModeFactor.textContent = "Standard";
                predictionImpact.textContent = "Most likely scenario";
            }
                        
            // Calculate category adjusted rank
            if (category === 'GM') {
                currentCategoryRank = currentRank;
                categoryFactor.textContent = "GM";
                categoryImpact.textContent = "No rank adjustment";
                categoryInfo.textContent = "For GM candidates";
            } else {
                // Apply category benefit (25% improvement)
                currentCategoryRank = Math.round(currentRank * 0.75);
                categoryFactor.textContent = category;
                categoryImpact.textContent = "Category benefit applied (25% rank improvement)";
                categoryInfo.textContent = `For ${category} candidates (with category benefit)`;
            }
                        
            // Calculate rank range (10%)
            const lowerRange = Math.round(currentRank * 0.9);
            const upperRange = Math.round(currentRank * 1.1);
            rankRange.textContent = `${lowerRange.toLocaleString()} to ${upperRange.toLocaleString()}`;
                        
            // Calculate percentile
            const percentile = ((currentRank / 100000) * 100).toFixed(1);
            rankPercentile.textContent = `Top ${percentile}%`;
                        
            // Set rank quality
            setRankQuality(currentRank);
                        
            // Set rank interpretation
            setRankInterpretation(currentRank);
                        
            // Animate the rank counter
            animateRankCounter(finalRank, currentRank);
            animateRankCounter(categoryRank, currentCategoryRank);
                        
            // Switch to result tab
            switchTab('result');
        }
                
        function setRankQuality(rank) {
            let quality = "";
            let percent = 0;
                        
            if (rank <= 1000) {
                quality = "Excellent";
                percent = 95;
            } else if (rank <= 5000) {
                quality = "Very Good";
                percent = 85;
            } else if (rank <= 10000) {
                quality = "Good";
                percent = 70;
            } else if (rank <= 25000) {
                quality = "Average";
                percent = 50;
            } else {
                quality = "Needs Improvement";
                percent = 30;
            }
                        
            rankQualityText.textContent = quality;
                        
            // Animate the circle
            const radius = rankQualityCircle.r.baseVal.value;
            const circumference = 2 * Math.PI * radius;
            const offset = circumference - (percent / 100) * circumference;
                        
            rankQualityCircle.style.strokeDasharray = circumference;
            rankQualityCircle.style.strokeDashoffset = offset;
                        
            // Set color based on quality
            if (quality === "Excellent") {
                rankQualityCircle.style.stroke = "#10B981"; // green
            } else if (quality === "Very Good") {
                rankQualityCircle.style.stroke = "#3B82F6"; // blue
            } else if (quality === "Good") {
                rankQualityCircle.style.stroke = "#F59E0B"; // yellow
            } else if (quality === "Average") {
                rankQualityCircle.style.stroke = "#F97316"; // orange
            } else {
                rankQualityCircle.style.stroke = "#EF4444"; // red
            }
        }
                
        function setRankInterpretation(rank) {
            let interpretation = "";
                        
            if (rank <= 500) {
                interpretation = "With this rank, you have excellent chances of getting into top government engineering colleges like RVCE, PES, and BMS for most branches including Computer Science. You're likely to qualify for KCET Round 1 counseling.";
            } else if (rank <= 2000) {
                interpretation = "This rank puts you in a strong position for most engineering colleges in Bangalore. You have good chances for Computer Science in tier-1 private colleges and other branches in government colleges. Consider applying for COMEDK as well.";
            } else if (rank <= 5000) {
                interpretation = "You're competitive for many good private colleges and some government college branches (excluding CS in top colleges). Focus on improving your rank further for better options. Consider mid-tier colleges like Dayananda Sagar, MS Ramaiah, etc.";
            } else if (rank <= 10000) {
                interpretation = "This rank range suggests you should research colleges carefully. You may get branches like Mechanical, Civil, or Electronics in some government colleges and good private colleges. Consider your branch preferences carefully.";
            } else if (rank <= 20000) {
                interpretation = "You'll need to explore a wider range of colleges with this rank. Focus on colleges beyond the top tier and consider branches that match your interests. Private colleges with good infrastructure might be better options.";
            } else {
                interpretation = "With this rank, you should consider all available options including lesser-known colleges. Focus on colleges with good placement records rather than just reputation. You might also consider improving your marks through KCET improvement exams or exploring other entrance exams.";
            }
                        
            rankInterpretation.innerHTML = interpretation;
        }
                
        function animateRankCounter(element, target) {
            const duration = 2000; // Animation duration in ms
            const start = 0;
            const increment = target / (duration / 16); // 60fps
                        
            let current = start;
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    clearInterval(timer);
                    current = target;
                }
                element.textContent = Math.round(current).toLocaleString();
            }, 16);
        }
                
        function renderColleges(tier) {
            // Clear existing colleges
            collegeContainer.innerHTML = '';
                        
            // Filter colleges based on tier
            let filteredColleges = colleges;
            if (tier !== 'all') {
                filteredColleges = colleges.filter(college => college.tier === tier);
            }
                        
            // Sort colleges by cutoff (ascending)
            filteredColleges.sort((a, b) => a.branches[0].cutoff - b.branches[0].cutoff);
                        
            // Render each college
            filteredColleges.forEach(college => {
                const collegeCard = document.createElement('div');
                collegeCard.className = 'college-card bg-gray-700 rounded-xl p-6 hover:bg-gray-600 transition-all';
                                
                // College header with badge
                let headerHtml = `
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-lg font-bold">${college.name}</h3>
                `;
                                
                if (college.badge) {
                    headerHtml += `
                        <span class="${college.badgeColor} text-white text-xs font-bold px-2 py-1 rounded-full">
                            ${college.badge}
                        </span>
                    `;
                }
                                
                headerHtml += `</div>`;
                                
                // Branches list
                let branchesHtml = '<div class="space-y-3">';
                college.branches.forEach(branch => {
                    let chanceClass = '';
                    let chanceIcon = '';
                                    
                    if (branch.yourChance === 'high') {
                        chanceClass = 'bg-green-900 text-green-300';
                        chanceIcon = '<i class="fas fa-check-circle mr-1"></i>';
                    } else if (branch.yourChance === 'medium') {
                        chanceClass = 'bg-yellow-900 text-yellow-300';
                        chanceIcon = '<i class="fas fa-info-circle mr-1"></i>';
                    } else {
                        chanceClass = 'bg-red-900 text-red-300';
                        chanceIcon = '<i class="fas fa-exclamation-circle mr-1"></i>';
                    }
                                    
                    branchesHtml += `
                        <div class="flex justify-between items-center">
                            <span>${branch.name}</span>
                            <div class="flex items-center">
                                <span class="text-sm font-medium mr-2">Cutoff: ${branch.cutoff.toLocaleString()}</span>
                                <span class="text-xs ${chanceClass} px-2 py-1 rounded-full">
                                    ${chanceIcon}${branch.yourChance.charAt(0).toUpperCase() + branch.yourChance.slice(1)} Chance
                                </span>
                            </div>
                        </div>
                    `;
                });
                branchesHtml += '</div>';
                                
                // Disclaimer
                const disclaimerHtml = `
                    <div class="mt-4 text-xs text-gray-400">
                        <i class="fas fa-info-circle mr-1"></i>
                        Cutoffs based on previous year data. Your actual chances may vary.
                    </div>
                `;
                                
                // Put it all together
                collegeCard.innerHTML = headerHtml + branchesHtml + disclaimerHtml;
                collegeContainer.appendChild(collegeCard);
            });
                        
            // If no colleges match the filter
            if (filteredColleges.length === 0) {
                collegeContainer.innerHTML = `
                    <div class="col-span-full text-center py-8 text-gray-400">
                        <i class="fas fa-university text-4xl mb-3"></i>
                        <p>No colleges match your current filter.</p>
                        <p class="text-sm mt-2">Try adjusting your filters or improving your predicted rank.</p>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>
