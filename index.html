<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KCET 2025 Rank Predictor | Elite Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/konfetti@1.2.0/dist/konfetti.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanilla-tilt@1.7.0/dist/vanilla-tilt.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <style>
        :root {
            --primary: #6d28d9;
            --secondary: #a78bfa;
            --accent: #ec4899;
            --light: #f5f3ff;
            --dark: #1e1b4b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
            --bg: linear-gradient(135deg, #f5f3ff 0%, #e9d5ff 100%);
            --text: #1e1b4b;
            --card-bg: rgba(255, 255, 255, 0.95);
            --shadow: 0 8px 24px rgba(0, 0, 0, 0.1), 0 0 16px rgba(109, 40, 217, 0.2);
            --interactive-border: rgba(255, 255, 255, 0.8);
        }

        [data-theme="dark"] {
            --bg: linear-gradient(135deg, #1e1b4b 0%, #4c1d95 100%);
            --text: #f5f3ff;
            --card-bg: rgba(67, 56, 202, 0.95);
            --shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
            --interactive-border: rgba(167, 139, 250, 0.6);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--bg);
            min-height: 100vh;
            color: var(--text);
            transition: background 0.5s ease, color 0.5s ease;
            overflow-x: hidden;
            position: relative;
        }

        #particles-js {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.6;
        }

        .container {
            max-width: 1440px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }

        .glass-card {
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: var(--shadow);
            padding: 2rem;
            transition: transform 0.4s ease, box-shadow 0.4s ease;
        }

        .glass-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.15);
        }

        .gradient-text {
            background: linear-gradient(90deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 900;
        }

        .gradient-bg {
            background: linear-gradient(90deg, var(--primary), var(--accent));
            transition: background 0.3s ease;
        }

        .gradient-bg:hover {
            background: linear-gradient(90deg, var(--accent), var(--primary));
        }

        .premium-btn {
            position: relative;
            overflow: hidden;
            border: 2px solid var(--interactive-border);
            transition: all 0.3s ease;
            animation: pulse-border 2s infinite;
        }

        .premium-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 20px rgba(109, 40, 217, 0.5);
            border-color: var(--accent);
        }

        @keyframes pulse-border {
            0%, 100% { border-color: var(--interactive-border); }
            50% { border-color: var(--accent); }
        }

        .fab {
            position: fixed;
            bottom: 2.5rem;
            right: 2.5rem;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent), var(--primary));
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.75rem;
            box-shadow: 0 10px 30px rgba(236, 72, 153, 0.5);
            cursor: pointer;
            animation: bounce 2.5s infinite;
            z-index: 1000;
            border: 2px solid var(--interactive-border);
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-12px); }
        }

        .tab-content {
            display: none;
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease, transform 0.6s ease;
        }

        .tab-content.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        .tab-nav {
            display: flex;
            overflow-x: auto;
            scroll-behavior: smooth;
            scrollbar-width: none;
            position: relative;
        }

        .tab-nav::-webkit-scrollbar {
            display: none;
        }

        .tab-btn {
            padding: 0.75rem 1.5rem;
            border: 2px solid var(--interactive-border);
            background: transparent;
            color: var(--text);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.05rem;
            position: relative;
            min-width: 120px;
            border-radius: 12px;
            margin-right: 0.5rem;
        }

        .tab-btn.active {
            background: linear-gradient(90deg, var(--primary), var(--accent));
            color: #fff;
            border-color: transparent;
        }

        .tab-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(109, 40, 217, 0.3);
        }

        .category-btn {
            padding: 0.75rem 1.25rem;
            border-radius: 12px;
            font-size: 0.95rem;
            font-weight: 600;
            background: var(--card-bg);
            color: var(--text);
            border: 2px solid var(--interactive-border);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .category-btn.active {
            background: linear-gradient(90deg, var(--primary), var(--accent));
            color: #fff;
            border-color: transparent;
            box-shadow: 0 4px 15px rgba(109, 40, 217, 0.4);
        }

        #disclaimer-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, rgba(30, 27, 75, 0.96), rgba(76, 29, 149, 0.96));
            backdrop-filter: blur(20px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
            animation: fadeIn 0.7s ease;
        }

        #disclaimer-content {
            max-width: 95%;
            width: 640px;
            background: var(--card-bg);
            border-radius: 28px;
            padding: 2.5rem;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.25);
            text-align: center;
            max-height: 90vh;
            overflow-y: auto;
            font-size: 0.95rem;
            border: 2px solid var(--interactive-border);
        }

        .premium-icon {
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            color: var(--accent);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); }
            100% { transform: scale(1); }
        }

        .info-btn {
            position: relative;
            font-size: 0.8rem;
            color: var(--info);
            cursor: help;
            margin-left: 0.5rem;
        }

        .info-btn:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        .tooltip-text {
            visibility: hidden;
            width: 180px;
            background: var(--dark);
            color: #fff;
            text-align: center;
            border-radius: 8px;
            padding: 0.75rem;
            position: absolute;
            z-index: 1;
            bottom: 130%;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .theme-selector {
            display: flex;
            gap: 0.75rem;
            justify-content: center;
            margin-top: 1.5rem;
        }

        .theme-option {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid var(--interactive-border);
            transition: all 0.3s ease;
        }

        .theme-option:hover {
            transform: scale(1.15);
            box-shadow: 0 0 12px var(--accent);
        }

        .theme-option.active {
            border-color: var(--accent);
            box-shadow: 0 0 15px rgba(236, 72, 153, 0.6);
        }

        .mark-selector {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .mark-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(109, 40, 217, 0.4);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            animation: pulse-circle 3s infinite;
            border: 2px solid var(--interactive-border);
        }

        .mark-circle:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(109, 40, 217, 0.6);
        }

        @keyframes pulse-circle {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .mark-value {
            color: #fff;
            font-size: 1.75rem;
            font-weight: 800;
            text-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        .mark-controls {
            display: flex;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .mark-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: var(--card-bg);
            border: 2px solid var(--interactive-border);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--primary);
            font-size: 1.2rem;
        }

        .mark-btn:hover {
            background: linear-gradient(90deg, var(--primary), var(--accent));
            color: #fff;
            border-color: var(--accent);
            box-shadow: 0 4px 12px rgba(109, 40, 217, 0.4);
        }

        .rank-meter {
            display: flex;
            justify-content: center;
            margin: 2rem 0;
        }

        .meter-circle {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 25px rgba(109, 40, 217, 0.5);
            transition: transform 0.4s ease;
            animation: pulse-circle 3s infinite;
            border: 2px solid var(--interactive-border);
        }

        .meter-circle.animate__pulse {
            animation: pulse 1.5s ease-in-out;
        }

        .meter-text {
            color: #fff;
            font-size: 2rem;
            font-weight: 900;
            text-shadow: 0 3px 8px rgba(0, 0, 0, 0.4);
        }

        .trend-canvas, .range-canvas, .compare-canvas, .progress-canvas {
            max-width: 600px;
            max-height: 300px;
            margin: 0 auto;
            background: var(--card-bg);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
            border: 2px solid var(--interactive-border);
        }

        .trend-canvas:hover, .range-canvas:hover, .compare-canvas:hover, .progress-canvas:hover {
            transform: translateY(-8px);
        }

        .breakdown-buttons {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            margin-top: 2.5rem;
        }

        .input-field {
            background: var(--card-bg);
            border: 2px solid var(--interactive-border);
            border-radius: 12px;
            padding: 0.75rem;
            color: var(--text);
            transition: all 0.3s ease;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 10px rgba(109, 40, 217, 0.4);
        }

        .range-slider {
            -webkit-appearance: none;
            width: 100%;
            height: 10px;
            border-radius: 5px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            outline: none;
            opacity: 0.9;
            transition: opacity 0.2s;
            border: 2px solid var(--interactive-border);
        }

        .range-slider:hover {
            opacity: 1;
        }

        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--accent);
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            border: 2px solid var(--interactive-border);
        }

        .range-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--accent);
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            border: 2px solid var(--interactive-border);
        }

        @media (max-width: 768px) {
            .container { padding: 1.5rem 1rem; }
            .glass-card { padding: 1.5rem; }
            .mark-circle { width: 100px; height: 100px; }
            .mark-value { font-size: 1.5rem; }
            .mark-btn { width: 40px; height: 40px; font-size: 1rem; }
            .meter-circle { width: 120px; height: 120px; }
            .meter-text { font-size: 1.75rem; }
            .trend-canvas, .range-canvas, .compare-canvas, .progress-canvas { max-width: 100%; }
            .fab { width: 60px; height: 60px; font-size: 1.5rem; bottom: 2rem; right: 2rem; }
            h1 { font-size: 2.5rem; }
            h2 { font-size: 1.85rem; }
            #disclaimer-content { padding: 1.75rem; width: 90%; font-size: 0.9rem; }
            #disclaimer-content h2 { font-size: 1.75rem; }
            .premium-btn, .tab-btn, .category-btn, .input-field, .range-slider { border-width: 1px; }
            .theme-option { width: 28px; height: 28px; }
            .tab-btn { font-size: 0.95rem; padding: 0.5rem 1rem; min-width: 100px; }
        }

        @media (max-width: 480px) {
            h1 { font-size: 2rem; }
            h2 { font-size: 1.5rem; }
            .mark-circle { width: 80px; height: 80px; }
            .mark-value { font-size: 1.25rem; }
            .mark-btn { width: 36px; height: 36px; font-size: 0.9rem; }
            .meter-circle { width: 100px; height: 100px; }
            .meter-text { font-size: 1.5rem; }
            .tab-btn { font-size: 0.85rem; padding: 0.5rem 0.75rem; min-width: 80px; }
            #disclaimer-content { padding: 1.25rem; font-size: 0.85rem; }
            #disclaimer-content h2 { font-size: 1.5rem; }
            .fab { width: 50px; height: 50px; font-size: 1.25rem; }
            .theme-option { width: 24px; height: 24px; }
        }
    </style>
</head>
<body>
    <div id="particles-js"></div>

    <div id="disclaimer-overlay" class="animate__animated animate__fadeIn">
        <div id="disclaimer-content" class="animate__animated animate__zoomIn">
            <i class="fas fa-shield-alt premium-icon"></i>
            <h2 class="text-2xl font-bold mb-6 gradient-text">Important Disclaimer</h2>
            <div class="space-y-4 text-gray-700 leading-relaxed">
                <p class="flex items-start"><i class="fas fa-info-circle mr-2 mt-1 text-blue-500"></i><span><strong>Estimate Only:</strong> This tool provides rank predictions based on historical KCET data (2023–2025, ~3.12 lakh candidates). It is not an official KEA result.</span></p>
                <p class="flex items-start"><i class="fas fa-exclamation-triangle mr-2 mt-1 text-yellow-500"></i><span><strong>Accuracy Limitations:</strong> Predictions may vary due to score normalization, exam difficulty, or KEA policy changes.</span></p>
                <p class="flex items-start"><i class="fas fa-ban mr-2 mt-1 text-red-500"></i><span><strong>Eligibility Restrictions:</strong> Per KEA 2024 rules, IIT/NIT students via JEE are barred from CET counseling.</span></p>
                <p class="flex items-start"><i class="fas fa-link mr-2 mt-1 text-blue-500"></i><span><strong>Official Source:</strong> Verify results at <a href="https://kea.kar.nic.in" target="_blank" class="underline hover:text-blue-600">kea.kar.nic.in</a>.</span></p>
                <p class="flex items-start"><i class="fas fa-lock mr-2 mt-1 text-green-500"></i><span><strong>Data Privacy:</strong> All inputs are processed locally. No data is stored or shared.</span></p>
                <p class="flex items-start"><i class="fas fa-hand-paper mr-2 mt-1 text-red-500"></i><span><strong>No Liability:</strong> Not affiliated with KEA or NTA. No responsibility for errors.</span></p>
                <p class="flex items-start"><i class="fas fa-users mr-2 mt-1 text-purple-500"></i><span><strong>Category Usage:</strong> Category selection impacts college cutoffs, not ranks.</span></p>
                <p class="text-xs italic text-gray-500 mt-4">Wait for the timer to unlock...</p>
            </div>
            <div class="mt-6 text-center">
                <p class="text-sm font-semibold text-gray-700" id="disclaimer-timer">Unlock in 10s...</p>
                <button id="unlock-btn" class="mt-4 w-full gradient-bg text-white py-2.5 px-5 rounded-xl text-base font-semibold premium-btn disabled:opacity-50" disabled>
                    <i class="fas fa-unlock-alt mr-2"></i> Unlock Predictor
                </button>
                <button id="close-disclaimer" class="mt-2 text-gray-500 hover:text-gray-700 text-sm"><i class="fas fa-times mr-1"></i> Close (After Unlock)</button>
            </div>
        </div>
    </div>

    <div class="container" id="main-content" style="pointer-events: none; opacity: 0.5; transition: opacity 0.5s ease">
        <header class="text-center mb-12 animate__animated animate__fadeInDown">
            <div class="inline-block p-6 bg-white rounded-full shadow-2xl mb-5 animate__animated animate__zoomIn">
                <i class="fas fa-crown text-5xl gradient-text"></i>
            </div>
            <h1 class="text-5xl font-extrabold mb-4"><span class="gradient-text">KCET 2025</span> Elite Predictor</h1>
            <p class="text-lg text-gray-600 max-w-md mx-auto animate__animated animate__fadeIn animate__delay-1s">Unleash your potential with cutting-edge rank predictions!</p>
            <div class="theme-selector animate__animated animate__fadeIn animate__delay-2s">
                <div class="theme-option active" data-theme="light" style="background: #f5f3ff;" title="Light"></div>
                <div class="theme-option" data-theme="dark" style="background: #4c1d95;" title="Dark"></div>
            </div>
        </header>

        <section class="glass-card mb-12 p-6 animate__animated animate__fadeIn banner" data-tilt data-tilt-max="10">
            <div class="flex items-start">
                <div class="flex-shrink-0 pt-1">
                    <i class="fas fa-exclamation-triangle text-red-600 text-2xl"></i>
                </div>
                <div class="ml-4">
                    <h3 class="text-xl font-semibold text-red-800">Read the Disclaimer</h3>
                    <p class="text-base text-red-700">
                        Predictions are estimates only.
                        <a href="#" class="font-medium underline hover:text-red-900" onclick="switchTab('disclaimer')">Learn more</a>
                    </p>
                </div>
            </div>
        </section>

        <section class="glass-card p-6 animate__animated animate__fadeInUp" data-tilt data-tilt-max="10">
            <nav class="flex mb-8 tab-nav">
                <button class="tab-btn active" data-tab="predictor"><i class="fas fa-calculator mr-2"></i> Predictor</button>
                <button class="tab-btn" data-tab="breakdown"><i class="fas fa-chart-pie mr-2"></i> Breakdown</button>
                <button class="tab-btn" data-tab="progress"><i class="fas fa-chart-line mr-2"></i> Progress</button>
                <button class="tab-btn" data-tab="disclaimer"><i class="fas fa-exclamation-triangle mr-2"></i> Disclaimer</button>
            </nav>

            <div class="tab-content active" id="predictor">
                <h2 class="text-3xl font-bold mb-8 flex items-center animate__animated animate__fadeIn"><i class="fas fa-calculator mr-3 gradient-text"></i> Rank Predictor</h2>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2 space-y-8">
                        <div class="glass-card p-6 animate__animated animate__fadeIn" data-tilt data-tilt-max="8">
                            <h3 class="text-2xl font-semibold mb-5 gradient-text">Quick Estimate</h3>
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 mb-5">
                                <div>
                                    <label class="block text-base font-medium text-gray-700 mb-2">KCET PCM (0-180)</label>
                                    <input type="number" id="quick-cet" class="w-full input-field" placeholder="e.g., 90" min="0" max="180">
                                </div>
                                <div>
                                    <label class="block text-base font-medium text-gray-700 mb-2">PUC PCM % (0-100)</label>
                                    <input type="number" id="quick-puc" class="w-full input-field" placeholder="e.g., 85" min="0" max="100">
                                </div>
                            </div>
                            <div id="quick-result" class="mt-5 hidden">
                                <p class="text-base text-gray-600">Estimated Rank: <span id="quick-rank" class="font-semibold gradient-text">---</span></p>
                                <p class="text-base text-gray-600">Range: <span id="quick-range" class="font-semibold">---</span></p>
                                <p class="text-base text-gray-600 mt-3" id="quick-analysis"></p>
                            </div>
                        </div>

                        <div class="glass-card p-6 animate__animated animate__fadeIn animate__delay-1s" data-tilt data-tilt-max="8">
                            <h3 class="text-2xl font-semibold mb-5 gradient-text">Detailed Calculator</h3>
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-8 mb-5">
                                <div class="mark-selector">
                                    <label class="block text-base font-medium text-gray-700 mb-3">KCET PCM (0-180)</label>
                                    <div class="mark-circle" onclick="focusInput('kcet-total')">
                                        <span class="mark-value" id="kcet-value">90</span>
                                    </div>
                                    <input type="range" id="kcet-total" class="range-slider mt-3" min="0" max="180" value="90">
                                    <div class="mark-controls">
                                        <button class="mark-btn large-dec" onclick="adjustMark('kcet', -10)">−−</button>
                                        <button class="mark-btn decrement" onclick="adjustMark('kcet', -1)">−</button>
                                        <button class="mark-btn increment" onclick="adjustMark('kcet', 1)">+</button>
                                        <button class="mark-btn large-inc" onclick="adjustMark('kcet', 10)">++</button>
                                    </div>
                                </div>
                                <div class="mark-selector">
                                    <label class="block text-base font-medium text-gray-700 mb-3">PUC PCM % (0-100)</label>
                                    <div class="mark-circle" onclick="focusInput('puc-percentage')">
                                        <span class="mark-value" id="puc-value">60</span>
                                    </div>
                                    <input type="range" id="puc-percentage" class="range-slider mt-3" min="0" max="100" value="60">
                                    <div class="mark-controls">
                                        <button class="mark-btn large-dec" onclick="adjustMark('puc', -10)">−−</button>
                                        <button class="mark-btn decrement" onclick="adjustMark('puc', -1)">−</button>
                                        <button class="mark-btn increment" onclick="adjustMark('puc', 1)">+</button>
                                        <button class="mark-btn large-inc" onclick="adjustMark('puc', 10)">++</button>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-5">
                                <label class="block text-base font-medium text-gray-700 mb-3">Category <i class="fas fa-info-circle info-btn"><span class="tooltip-text">Category affects college cutoffs, not ranks.</span></i></label>
                                <div class="flex flex-wrap gap-3">
                                    <button class="category-btn active" data-category="general">General</button>
                                    <button class="category-btn" data-category="obc">OBC</button>
                                    <button class="category-btn" data-category="sc">SC</button>
                                    <button class="category-btn" data-category="st">ST</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="glass-card p-6 animate__animated animate__fadeIn animate__delay-2s" data-tilt data-tilt-max="8">
                        <h3 class="text-2xl font-semibold mb-5 gradient-text">Your Elite Rank</h3>
                        <div class="rank-meter">
                            <div id="meterCircle" class="meter-circle">
                                <span id="predicted-rank" class="meter-text">---</span>
                            </div>
                        </div>
                        <p class="text-base text-gray-600 text-center">Range: <span id="predicted-range">---</span></p>
                        <p class="text-base text-gray-600 mt-3 text-center" id="competition-note"></p>
                        <div class="mt-5 text-center">
                            <p class="text-sm text-gray-500" id="social-proof">50,000 students predicted!</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="breakdown">
                <h2 class="text-3xl font-bold mb-8 flex items-center animate__animated animate__fadeIn"><i class="fas fa-chart-pie mr-3 gradient-text"></i> Result Breakdown</h2>
                <div id="breakdown-content" class="space-y-8">
                    <div class="text-center py-10 animate__animated animate__fadeIn">
                        <div class="inline-block p-5 bg-white rounded-full mb-3 animate__animated animate__pulse"><i class="fas fa-search text-3xl text-blue-600"></i></div>
                        <h3 class="text-xl font-medium text-gray-600 mb-2">Calculate to see stats</h3>
                        <p class="text-base text-gray-500">Detailed insights await</p>
                    </div>
                </div>
                <div class="mt-8 animate__animated animate__fadeIn">
                    <canvas id="trend-chart" class="trend-canvas"></canvas>
                </div>
                <div class="mt-8 animate__animated animate__fadeIn">
                    <canvas id="range-chart" class="range-canvas"></canvas>
                </div>
                <div class="breakdown-buttons animate__animated animate__fadeIn">
                    <button id="recalculate-btn" class="gradient-bg text-white py-2.5 px-5 rounded-xl text-base font-semibold premium-btn"><i class="fas fa-calculator mr-2"></i> Recalculate</button>
                    <button id="download-png-btn" class="gradient-bg text-white py-2.5 px-5 rounded-xl text-base font-semibold premium-btn"><i class="fas fa-image mr-2"></i> Download PNG</button>
                </div>
            </div>

            <div class="tab-content" id="progress">
                <h2 class="text-3xl font-bold mb-8 flex items-center animate__animated animate__fadeIn"><i class="fas fa-chart-line mr-3 gradient-text"></i> Progress Tracker</h2>
                <div id="progress-content" class="space-y-6 animate__animated animate__fadeIn">
                    <div class="text-center py-10">
                        <div class="inline-block p-5 bg-white rounded-full mb-3 animate__animated animate__pulse">
                            <i class="fas fa-history text-3xl text-blue-600"></i>
                        </div>
                        <h3 class="text-xl font-medium text-gray-600 mb-2">No Predictions Yet</h3>
                        <p class="text-base text-gray-500">Calculate your rank to track progress!</p>
                    </div>
                </div>
                <div class="mt-8 animate__animated animate__fadeIn">
                    <canvas id="progress-chart" class="progress-canvas"></canvas>
                </div>
            </div>

            <div class="tab-content" id="disclaimer">
                <h2 class="text-3xl font-bold mb-8 flex items-center animate__animated animate__fadeIn"><i class="fas fa-exclamation-triangle mr-3 gradient-text"></i> Disclaimer</h2>
                <div class="glass-card p-6 animate__animated animate__fadeIn" data-tilt data-tilt-max="8">
                    <h3 class="text-2xl font-semibold mb-5 gradient-text">Important Information</h3>
                    <div class="space-y-4 text-base text-gray-600">
                        <p class="flex items-start"><i class="fas fa-info-circle mr-2 mt-1 text-blue-500"></i><span><strong>Estimate Only:</strong> This tool provides rank predictions based on historical KCET data (2023–2025, ~3.12 lakh candidates). It is not an official KEA result.</span></p>
                        <p class="flex items-start"><i class="fas fa-exclamation-triangle mr-2 mt-1 text-yellow-500"></i><span><strong>Accuracy Limitations:</strong> Predictions may vary due to score normalization, exam difficulty, or KEA policy changes.</span></p>
                        <p class="flex items-start"><i class="fas fa-ban mr-2 mt-1 text-red-500"></i><span><strong>Eligibility Restrictions:</strong> Per KEA 2024 rules, IIT/NIT students via JEE are barred from CET counseling.</span></p>
                        <p class="flex items-start"><i class="fas fa-link mr-2 mt-1 text-blue-500"></i><span><strong>Official Source:</strong> Verify results at <a href="https://kea.kar.nic.in" target="_blank" class="underline hover:text-blue-600">kea.kar.nic.in</a>.</span></p>
                        <p class="flex items-start"><i class="fas fa-lock mr-2 mt-1 text-green-500"></i><span><strong>Data Privacy:</strong> All inputs are processed locally. No data is stored or shared.</span></p>
                        <p class="flex items-start"><i class="fas fa-hand-paper mr-2 mt-1 text-red-500"></i><span><strong>No Liability:</strong> Not affiliated with KEA or NTA. No responsibility for errors.</span></p>
                        <p class="flex items-start"><i class="fas fa-users mr-2 mt-1 text-purple-500"></i><span><strong>Category Usage:</strong> Category selection impacts college cutoffs, not ranks.</span></p>
                    </div>
                    <button id="reread-disclaimer" class="mt-6 w-full gradient-bg text-white py-2.5 px-5 rounded-xl text-base font-semibold premium-btn"><i class="fas fa-sync-alt mr-2"></i> Re-read Disclaimer</button>
                </div>
            </div>
        </section>
    </div>

    <button class="fab animate__animated animate__bounce" onclick="calculateRank()"><i class="fas fa-bolt"></i></button>

    <script>
        let disclaimerAccepted = false;
        let currentTimer = null;
        let trendChartInstance = null;
        let rangeChartInstance = null;
        let progressChartInstance = null;

        function safeLocalStorage(action, key, value) {
            try {
                if (action === 'set') {
                    localStorage.setItem(key, value);
                    return true;
                } else if (action === 'get') {
                    return localStorage.getItem(key);
                }
            } catch (err) {
                console.error('localStorage error:', err);
                return action === 'get' ? null : false;
            }
        }

        function playSound(type) {
            try {
                const sound = new Audio({
                    click: 'https://assets.mixkit.co/sfx/preview/mixkit-click-button-1110.mp3',
                    unlock: 'https://assets.mixkit.co/sfx/preview/mixkit-unlock-game-notification-253.mp3',
                    success: 'https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3'
                }[type] || 'https://assets.mixkit.co/sfx/preview/mixkit-click-button-1110.mp3');
                sound.play().catch(err => console.warn('Audio play failed:', err));
            } catch (err) {
                console.error('Sound error:', err);
            }
        }

        function switchTab(tabId) {
            try {
                document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
                document.getElementById(tabId).classList.add('active');
                playSound('click');
                if (tabId === 'progress') loadSavedResults();
                if (tabId === 'breakdown') updateBreakdown(0, { low: 0, medium: 0, high: 0 }, 0, 0, 'init');
            } catch (err) {
                console.error('Tab switch error:', err);
            }
        }

        function setTheme(theme) {
            try {
                document.documentElement.setAttribute('data-theme', theme);
                document.querySelectorAll('.theme-option').forEach(opt => opt.classList.remove('active'));
                document.querySelector(`.theme-option[data-theme="${theme}"]`).classList.add('active');
                safeLocalStorage('set', 'theme', theme);
                playSound('click');
            } catch (err) {
                console.error('Theme error:', err);
            }
        }

        function adjustMark(type, delta) {
            try {
                const input = document.getElementById(type === 'kcet' ? 'kcet-total' : 'puc-percentage');
                let value = parseFloat(input.value) + delta;
                value = Math.max(parseFloat(input.min), Math.min(parseFloat(input.max), value));
                input.value = value;
                updateMark(type, value);
                playSound('click');
            } catch (err) {
                console.error('Adjust mark error:', err);
            }
        }

        function updateMark(type, value) {
            try {
                const valueDisplay = document.getElementById(type === 'kcet' ? 'kcet-value' : 'puc-value');
                valueDisplay.textContent = value;
                updateRankLive('detailed');
            } catch (err) {
                console.error('Update mark error:', err);
            }
        }

        function focusInput(id) {
            try {
                document.getElementById(id).focus();
                playSound('click');
            } catch (err) {
                console.error('Focus input error:', err);
            }
        }

        function predictKCETRank(cet, puc) {
            try {
                const composite = (cet / 180 * 50) + (puc / 100 * 50);
                let rank;
                if (composite >= 90) rank = 1000 + (100 - composite) * 100;
                else if (composite >= 80) rank = 5000 + (90 - composite) * 400;
                else if (composite >= 70) rank = 15000 + (80 - composite) * 1000;
                else if (composite >= 60) rank = 30000 + (70 - composite) * 2000;
                else rank = 50000 + (60 - composite) * 3000;
                rank = Math.max(1, Math.round(rank));
                const rangeFactor = composite >= 90 ? 0.1 : composite >= 80 ? 0.15 : 0.2;
                return {
                    medium: rank,
                    low: Math.max(1, Math.round(rank * (1 - rangeFactor))),
                    high: Math.round(rank * (1 + rangeFactor))
                };
            } catch (err) {
                console.error('Rank prediction error:', err);
                throw err;
            }
        }

        function getRankAnalysis(rank) {
            try {
                if (rank <= 1000) return 'Elite rank! Likely to secure top colleges like RVCE or BMSCE.';
                if (rank <= 5000) return 'Great rank! Strong chances for top branches.';
                if (rank <= 15000) return 'Solid rank! Good college options available.';
                if (rank <= 30000) return 'Moderate rank. Explore various colleges.';
                return 'Lower rank. Consider all possible options.';
            } catch (err) {
                console.error('Rank analysis error:', err);
                return 'Error in analysis.';
            }
        }

        function updateRankLive(type) {
            try {
                if (type === 'quick') {
                    const cet = parseFloat(document.getElementById('quick-cet').value) || 0;
                    const puc = parseFloat(document.getElementById('quick-puc').value) || 0;
                    if (cet >= 0 && cet <= 180 && puc >= 0 && puc <= 100) {
                        const rankData = predictKCETRank(cet, puc);
                        document.getElementById('quick-rank').textContent = rankData.medium.toLocaleString();
                        document.getElementById('quick-range').textContent = `${rankData.low.toLocaleString()}–${rankData.high.toLocaleString()}`;
                        document.getElementById('quick-analysis').textContent = getRankAnalysis(rankData.medium);
                        document.getElementById('quick-result').classList.remove('hidden');
                    } else {
                        document.getElementById('quick-result').classList.add('hidden');
                    }
                } else if (type === 'detailed') {
                    const cet = parseFloat(document.getElementById('kcet-total').value) || 0;
                    const puc = parseFloat(document.getElementById('puc-percentage').value) || 0;
                    if (cet >= 0 && cet <= 180 && puc >= 0 && puc <= 100) {
                        const rankData = predictKCETRank(cet, puc);
                        document.getElementById('predicted-rank').textContent = rankData.medium.toLocaleString();
                        document.getElementById('predicted-range').textContent = `${rankData.low.toLocaleString()}–${rankData.high.toLocaleString()}`;
                        document.getElementById('competition-note').textContent = getRankAnalysis(rankData.medium);
                    }
                }
            } catch (err) {
                console.error('Update rank live error:', err);
            }
        }

        function calculateRank() {
            try {
                const cet = parseFloat(document.getElementById('kcet-total').value) || 0;
                const puc = parseFloat(document.getElementById('puc-percentage').value) || 0;
                const category = document.querySelector('.category-btn.active')?.dataset.category || 'general';
                if (cet < 0 || cet > 180 || puc < 0 || puc > 100) {
                    alert('Please enter valid scores: KCET (0-180), PUC (0-100).');
                    return;
                }
                const composite = (cet / 180 * 50) + (puc / 100 * 50);
                const rankData = predictKCETRank(cet, puc);
                updateMainRank(rankData);
                updateBreakdown(composite, rankData, cet, puc, 'calculate');
                saveResult(cet, puc, rankData, category);
                generateRankCard(cet, puc, rankData, category);
                playSound('success');
                triggerConfetti();
                switchTab('breakdown');
            } catch (err) {
                console.error('Calculate rank error:', err);
                alert('An error occurred while calculating your rank.');
            }
        }

        function updateMainRank(rankData) {
            try {
                const rankDisplay = document.getElementById('predicted-rank');
                const rangeDisplay = document.getElementById('predicted-range');
                const noteDisplay = document.getElementById('competition-note');
                const meterCircle = document.getElementById('meterCircle');
                rankDisplay.textContent = rankData.medium.toLocaleString();
                rangeDisplay.textContent = `${rankData.low.toLocaleString()}–${rankData.high.toLocaleString()}`;
                noteDisplay.textContent = getRankAnalysis(rankData.medium);
                meterCircle.classList.add('animate__pulse');
                setTimeout(() => meterCircle.classList.remove('animate__pulse'), 1500);
            } catch (err) {
                console.error('Update main rank error:', err);
            }
        }

        function updateBreakdown(composite, rankData, cet, puc, source) {
            try {
                const breakdownContent = document.getElementById('breakdown-content');
                breakdownContent.innerHTML = `
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 animate__animated animate__fadeIn">
                        <div class="glass-card p-5" data-tilt data-tilt-max="8">
                            <h3 class="text-xl font-semibold mb-3 gradient-text">Score Breakdown</h3>
                            <p class="text-base">KCET: ${cet.toFixed(1)}/180 (${((cet / 180) * 100).toFixed(1)}%)</p>
                            <p class="text-base">PUC: ${puc.toFixed(1)}% (${puc.toFixed(1)}%)</p>
                            <p class="text-base">Composite: ${composite.toFixed(1)}%</p>
                        </div>
                        <div class="glass-card p-5" data-tilt data-tilt-max="8">
                            <h3 class="text-xl font-semibold mb-3 gradient-text">Rank Insights</h3>
                            <p class="text-base">Predicted Rank: ${rankData.medium.toLocaleString()}</p>
                            <p class="text-base">Range: ${rankData.low.toLocaleString()}–${rankData.high.toLocaleString()}</p>
                            <p class="text-base">${getRankAnalysis(rankData.medium)}</p>
                        </div>
                    </div>
                `;
                updateTrendChart(cet, puc, rankData);
                updateRangeChart(rankData);
                initializeTilt();
            } catch (err) {
                console.error('Update breakdown error:', err);
            }
        }

        function updateTrendChart(cet, puc, rankData) {
            try {
                const ctx = document.getElementById('trend-chart').getContext('2d');
                if (trendChartInstance) trendChartInstance.destroy();
                trendChartInstance = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['KCET', 'PUC', 'Rank'],
                        datasets: [{
                            label: 'Score Trend',
                            data: [cet, puc, rankData.medium / 1000],
                            borderColor: '#6d28d9',
                            backgroundColor: 'rgba(109, 40, 217, 0.2)',
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: { beginAtZero: true, title: { display: true, text: 'Value' } }
                        },
                        plugins: {
                            legend: { display: false },
                            title: { display: true, text: 'Score vs Rank Trend', font: { size: 16 } }
                        }
                    }
                });
            } catch (err) {
                console.error('Trend chart error:', err);
            }
        }

        function updateRangeChart(rankData) {
            try {
                const ctx = document.getElementById('range-chart').getContext('2d');
                if (rangeChartInstance) rangeChartInstance.destroy();
                rangeChartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Low', 'Medium', 'High'],
                        datasets: [{
                            label: 'Rank Range',
                            data: [rankData.low, rankData.medium, rankData.high],
                            backgroundColor: ['#10b981', '#6d28d9', '#ec4899']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: { beginAtZero: true, title: { display: true, text: 'Rank' } }
                        },
                        plugins: {
                            legend: { display: false },
                            title: { display: true, text: 'Rank Range', font: { size: 16 } }
                        }
                    }
                });
            } catch (err) {
                console.error('Range chart error:', err);
            }
        }

        function saveResult(cet, puc, rankData, category) {
            try {
                const results = JSON.parse(safeLocalStorage('get', 'results') || '[]');
                results.push({
                    cet,
                    puc,
                    rank: rankData.medium,
                    range: `${rankData.low}–${rankData.high}`,
                    category,
                    timestamp: new Date().toISOString()
                });
                safeLocalStorage('set', 'results', JSON.stringify(results));
            } catch (err) {
                console.error('Save result error:', err);
            }
        }

        function loadSavedResults() {
            try {
                const results = JSON.parse(safeLocalStorage('get', 'results') || '[]');
                const container = document.getElementById('progress-content');
                if (results.length > 0) {
                    container.innerHTML = results.map((r, i) => `
                        <div class="glass-card p-5 animate__animated animate__fadeIn animate__delay-${i}s" data-tilt data-tilt-max="8">
                            <h3 class="text-base font-semibold gradient-text">Attempt ${i + 1}</h3>
                            <p class="text-sm">${new Date(r.timestamp).toLocaleString()}</p>
                            <p class="text-sm">CET: ${r.cet}, PUC: ${r.puc}%</p>
                            <p class="text-sm">Rank: ${r.rank.toLocaleString()} (${r.range})</p>
                            <p class="text-sm">Category: ${r.category}</p>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = `
                        <div class="text-center py-10 animate__animated animate__fadeIn">
                            <div class="inline-block p-5 bg-white rounded-full mb-3 animate__animated animate__pulse">
                                <i class="fas fa-history text-3xl text-blue-600"></i>
                            </div>
                            <h3 class="text-xl font-medium text-gray-600 mb-2">No Predictions Yet</h3>
                            <p class="text-base text-gray-500">Calculate your rank to track progress!</p>
                        </div>
                    `;
                }
                updateProgressChart();
                initializeTilt();
            } catch (err) {
                console.error('Load saved results error:', err);
            }
        }

        function updateProgressChart() {
            try {
                const results = JSON.parse(safeLocalStorage('get', 'results') || '[]');
                const ctx = document.getElementById('progress-chart').getContext('2d');
                if (progressChartInstance) progressChartInstance.destroy();
                progressChartInstance = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: results.length > 0 ? results.map((r, i) => `Attempt ${i + 1}`) : ['No Data'],
                        datasets: [{
                            label: 'Rank Progress',
                            data: results.length > 0 ? results.map(r => r.rank) : [0],
                            borderColor: '#6d28d9',
                            backgroundColor: 'rgba(109, 40, 217, 0.2)',
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: { beginAtZero: true, title: { display: true, text: 'Rank' } }
                        },
                        plugins: {
                            legend: { display: false },
                            title: { display: true, text: 'Rank Progress Over Time', font: { size: 16 } }
                        }
                    }
                });
            } catch (err) {
                console.error('Progress chart error:', err);
            }
        }

        function generateRankCard(cet, puc, rankData, category) {
            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                doc.setFont('Poppins', 'bold');
                doc.setFontSize(24);
                doc.setTextColor(109, 40, 217);
                doc.text('KCET 2025 Rank Card', 105, 20, { align: 'center' });
                doc.setFontSize(14);
                doc.setTextColor(0);
                doc.text(`KCET Score: ${cet}/180`, 20, 50);
                doc.text(`PUC Percentage: ${puc}%`, 20, 60);
                doc.text(`Predicted Rank: ${rankData.medium.toLocaleString()}`, 20, 70);
                doc.text(`Rank Range: ${rankData.low.toLocaleString()}–${rankData.high.toLocaleString()}`, 20, 80);
                doc.text(`Category: ${category}`, 20, 90);
                doc.text(`Generated on: ${new Date().toLocaleString()}`, 20, 100);
                doc.setFontSize(12);
                doc.setTextColor(100);
                doc.text('KCET Elite Rank Predictor', 105, 120, { align: 'center' });
                doc.save('KCET_2025_Rank_Card.pdf');
            } catch (err) {
                console.error('Generate rank card error:', err);
            }
        }

        function downloadBreakdownPNG() {
            try {
                const trendCanvas = document.getElementById('trend-chart');
                const rangeCanvas = document.getElementById('range-chart');
                const tempCanvas = document.createElement('canvas');
                const ctx = tempCanvas.getContext('2d');
                tempCanvas.width = 600;
                tempCanvas.height = 600;

                ctx.fillStyle = '#f5f3ff';
                ctx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);

                ctx.drawImage(trendCanvas, 0, 0, 600, 300);
                ctx.drawImage(rangeCanvas, 0, 300, 600, 300);

                ctx.fillStyle = '#6d28d9';
                ctx.font = 'bold 20px Poppins';
                ctx.textAlign = 'center';
                ctx.fillText('KCET 2025 Breakdown', 300, 30);

                const link = document.createElement('a');
                link.href = tempCanvas.toDataURL('image/png');
                link.download = 'KCET_2025_Breakdown.png';
                link.click();
            } catch (err) {
                console.error('Download PNG error:', err);
                alert('Failed to download PNG. Please try again.');
            }
        }

        function recalculateRank() {
            try {
                playSound('click');
                switchTab('predictor');
                document.getElementById('kcet-total').focus();
            } catch (err) {
                console.error('Recalculate rank error:', err);
            }
        }

        function triggerConfetti() {
            try {
                if (typeof konfetti === 'undefined') {
                    console.warn('Konfetti library not loaded');
                    return;
                }
                konfetti.create({
                    angle: 90,
                    spread: 90,
                    startVelocity: 40,
                    elementCount: 60,
                    colors: ['#6d28d9', '#a78bfa', '#ec4899'],
                    duration: 3500
                });
            } catch (err) {
                console.error('Confetti error:', err);
            }
        }

        function initializeTilt() {
            try {
                if (typeof VanillaTilt !== 'undefined') {
                    VanillaTilt.init(document.querySelectorAll('[data-tilt]'), {
                        max: 10,
                        speed: 400,
                        glare: true,
                        'max-glare': 0.3
                    });
                } else {
                    console.warn('VanillaTilt not loaded');
                }
            } catch (err) {
                console.error('Tilt initialization error:', err);
            }
        }

        function initializeApp() {
            try {
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.addEventListener('click', () => switchTab(btn.dataset.tab));
                    btn.addEventListener('touchstart', (e) => {
                        e.preventDefault();
                        switchTab(btn.dataset.tab);
                    });
                });

                document.querySelectorAll('.category-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        playSound('click');
                    });
                });

                document.querySelectorAll('.theme-option').forEach(opt => {
                    opt.addEventListener('click', () => setTheme(opt.dataset.theme));
                });

                ['kcet-total', 'puc-percentage'].forEach(id => {
                    const input = document.getElementById(id);
                    input.addEventListener('input', () => updateMark(id.includes('kcet') ? 'kcet' : 'puc', input.value));
                    input.addEventListener('change', () => updateRankLive('detailed'));
                });

                ['quick-cet', 'quick-puc'].forEach(id => {
                    document.getElementById(id).addEventListener('input', () => updateRankLive('quick'));
                });

                document.getElementById('download-png-btn').addEventListener('click', downloadBreakdownPNG);
                document.getElementById('recalculate-btn').addEventListener('click', recalculateRank);

                const savedTheme = safeLocalStorage('get', 'theme') || 'light';
                setTheme(savedTheme);

                loadSavedResults();
                updateRankLive('detailed');
                initializeTilt();
            } catch (err) {
                console.error('App initialization error:', err);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            try {
                if (typeof particlesJS !== 'undefined') {
                    particlesJS('particles-js', {
                        particles: {
                            number: { value: 60, density: { enable: true, value_area: 800 } },
                            color: { value: ['#6d28d9', '#a78bfa', '#ec4899'] },
                            shape: { type: 'circle' },
                            opacity: { value: 0.5, random: true },
                            size: { value: 4, random: true },
                            line_linked: { enable: false },
                            move: { enable: true, speed: 1.5, direction: 'none', random: true }
                        },
                        interactivity: {
                            detect_on: 'canvas',
                            events: { onhover: { enable: true, mode: 'repulse' }, onclick: { enable: true, mode: 'push' } },
                            modes: { repulse: { distance: 120, duration: 0.4 }, push: { particles_nb: 4 } }
                        }
                    });
                } else {
                    console.warn('particles.js not loaded');
                }

                const disclaimerOverlay = document.getElementById('disclaimer-overlay');
                const unlockBtn = document.getElementById('unlock-btn');
                const closeBtn = document.getElementById('close-disclaimer');
                const mainContent = document.getElementById('main-content');
                const timerDisplay = document.getElementById('disclaimer-timer');
                const rereadBtn = document.getElementById('reread-disclaimer');

                if (!disclaimerOverlay || !unlockBtn || !closeBtn || !mainContent || !timerDisplay || !rereadBtn) {
                    console.error('Missing DOM elements');
                    return;
                }

                function startTimer() {
                    if (currentTimer) clearInterval(currentTimer);
                    let timeLeft = 10;
                    timerDisplay.textContent = `Unlock in ${timeLeft}s...`;
                    unlockBtn.disabled = true;
                    unlockBtn.classList.remove('animate__pulse', 'animate__infinite');

                    currentTimer = setInterval(() => {
                        timeLeft--;
                        timerDisplay.textContent = `Unlock in ${timeLeft}s...`;
                        if (timeLeft <= 0) {
                            clearInterval(currentTimer);
                            currentTimer = null;
                            timerDisplay.textContent = 'Ready to unlock!';
                            unlockBtn.disabled = false;
                            unlockBtn.classList.add('animate__pulse', 'animate__infinite');
                        }
                    }, 1000);

                    setTimeout(() => {
                        if (timeLeft > 0) {
                            clearInterval(currentTimer);
                            currentTimer = null;
                            timerDisplay.textContent = 'Ready to unlock!';
                            unlockBtn.disabled = false;
                            unlockBtn.classList.add('animate__pulse', 'animate__infinite');
                        }
                    }, 11000);
                }

                startTimer();

                unlockBtn.addEventListener('click', () => {
                    if (unlockBtn.disabled) return;
                    try {
                        playSound('unlock');
                        disclaimerAccepted = true;
                        safeLocalStorage('set', 'disclaimerAccepted', 'true');
                        disclaimerOverlay.classList.add('animate__fadeOut');
                        setTimeout(() => {
                            disclaimerOverlay.style.display = 'none';
                            mainContent.style.pointerEvents = 'auto';
                            mainContent.style.opacity = '1';
                            initializeApp();
                        }, 700);
                    } catch (err) {
                        console.error('Unlock error:', err);
                    }
                });

                closeBtn.addEventListener('click', () => {
                    if (!disclaimerAccepted) return;
                    try {
                        playSound('click');
                        disclaimerOverlay.classList.add('animate__fadeOut');
                        setTimeout(() => {
                            disclaimerOverlay.style.display = 'none';
                            mainContent.style.pointerEvents = 'auto';
                            mainContent.style.opacity = '1';
                            initializeApp();
                        }, 700);
                    } catch (err) {
                        console.error('Close error:', err);
                    }
                });

                rereadBtn.addEventListener('click', () => {
                    try {
                        playSound('click');
                        disclaimerOverlay.style.display = 'flex';
                        disclaimerOverlay.classList.remove('animate__fadeOut');
                        disclaimerOverlay.classList.add('animate__fadeIn');
                        mainContent.style.pointerEvents = 'none';
                        mainContent.style.opacity = '0.5';
                        startTimer();
                    } catch (err) {
                        console.error('Reread error:', err);
                    }
                });

                if (safeLocalStorage('get', 'disclaimerAccepted') === 'true') {
                    disclaimerAccepted = true;
                    disclaimerOverlay.style.display = 'none';
                    mainContent.style.pointerEvents = 'auto';
                    mainContent.style.opacity = '1';
                    initializeApp();
                }

                const socialProof = document.getElementById('social-proof');
                if (socialProof) {
                    let userCount = 50000;
                    setInterval(() => {
                        userCount += Math.floor(Math.random() * 10) + 1;
                        socialProof.textContent = `${userCount.toLocaleString()} students predicted!`;
                        socialProof.classList.add('animate__pulse');
                        setTimeout(() => socialProof.classList.remove('animate__pulse'), 700);
                    }, 6000);
                }
            } catch (err) {
                console.error('DOMContentLoaded error:', err);
            }
        });
    </script>
</body>
</html>
